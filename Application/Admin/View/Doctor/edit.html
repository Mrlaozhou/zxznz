<layout name="layout" />

    <link href="__PUBLIC__/umeditor1_2_2-utf8-php/themes/default/css/umeditor.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="__PUBLIC__/umeditor1_2_2-utf8-php/third-party/jquery.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/umeditor1_2_2-utf8-php/umeditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/umeditor1_2_2-utf8-php/umeditor.min.js"></script>
    <script type="text/javascript" src="__PUBLIC__/umeditor1_2_2-utf8-php/lang/zh-cn/zh-cn.js"></script>
    
<div class="tab-div">
    <div id="tabbar-div">
        <p>
            <span class="tab-front">基本信息</span>
            <span class="tab-back">医生介绍</span>
            <span class="tab-back">职业经历</span>
        </p>
    </div>
    <div id="tabbody-div">
        <form method="post" action="__SELF__" enctype="multipart/form-data" >
            <!-- 基本信息 -->
            <table class="tab_content" cellspacing="1" cellpadding="3" width="100%">
                <tr>
                    <td class="label">医生名称</td>
                    <td>
                        <input type="text" name="name" size="20" maxlength="20" value="<?php echo $info['name'];?>" />
                        <span class="require-field">*</span>
                        <br /><br />
                    </td>
                </tr>
                <tr>
                    <td class="label">性别</td>
                    <td>
                        <input type="radio" name="sex" value="男" <?php if( $info['sex']=='男' ){ echo "checked='checked'";}?> /> 男
                        <input type="radio" name="sex" value="女" <?php if( $info['sex']=='女' ){ echo "checked='checked'";}?> /> 女
                        <br /><br />
                    </td>
                </tr>
                <tr>
                    <td class="label">职务</td>
                    <td>
                        <input type="text" name="duty" size="20" maxlength="20" value="<?php echo $info['duty'];?>" />
                        <span class="require-field">*</span>
                        <br /><br />
                    </td>
                </tr>
                <tr>
                    <td class="label">职称</td>
                    <td>
                        <input type="text" name="title" size="20" maxlength="20" value="<?php echo $info['title'];?>" />
                        <span class="require-field">*</span>
                        <br /><br />
                    </td>
                </tr>
                <tr>
                    <td class="label">从行时间</td>
                    <td>
                        <input type="text" name="start" size="20" maxlength="20" value="<?php echo $info['start'];?>" />
                        <span class="require-field">* 格式为：2017-01-01</span>
                        <br /><br />
                    </td>
                </tr>
                <tr>
                    <td class="label">医生照片</td>
                    <td>
                        <img style="width:50px;" src="__PUBLIC__/Uploads/<?php echo $info['picture'];?>"><br />
                        <input type="file" name="picture" />
                        <br /><br />
                    </td>
                </tr>
                <tr>
                    <td class="label">学历</td>
                    <td>
                        <select name="edu" now="<?php echo $info['edu'];?>">
                            <option value="">请选择学历</option>
                            <option <?php if( $info['edu']=='大专' ){ echo "selected='selected'"; }?> value="中专">中专</option>
                            <option <?php if( $info['edu']=='中专' ){ echo "selected='selected'"; }?> value="大专">大专</option>
                            <option value="本科" <?php if( $info['edu']=='本科' ){ echo "selected='selected'"; }?>>本科</option>
                            <option <?php if( $info['edu']=='研究生' ){ echo "selected='selected'"; }?> value="研究生">研究生</option>
                            <option <?php if( $info['edu']=='博士' ){ echo "selected='selected'"; }?> value="博士">博士</option>
                            <option <?php if( $info['edu']=='博士后' ){ echo "selected='selected'"; }?> value="博士后">博士后</option>
                        </select>
                        <br /><br />
                    </td>
                </tr>
                <tr>
                    <td class="label">擅长项目：</td>
                    <td>
                        <input type="text" size="60" name="good" value="<?php echo $info['good'];?>" /><br /><br />
                    </td>
                </tr>
                <tr>
                    <td class="label">是否显示</td>
                    <td>
                        <input type="radio" name="is_show" value="是" <?php if( $info['is_show']=='是'){ echo "checked='checked'"; }?> /> 是
                        <input type="radio" name="is_show" value="否" <?php if( $info['is_show']=='否' ){ echo "checked='checked'"; }?> /> 否
                        <br /><br />
                    </td>
                </tr>
                <tr>
                    <td class="label">显示到主页</td>
                    <td>
                        <input type="radio" name="is_index" value="1" <?php if( $info['is_index']=='1'){ echo "checked='checked'"; }?> /> 是
                        <input type="radio" name="is_index" value="0" <?php if( $info['is_index']=='0' ){ echo "checked='checked'"; }?> /> 否
                        <br /><br />
                    </td>
                </tr>

            </table>
            <!-- 医生描述 -->
            <table style="display:none;" class="tab_content" cellspacing="1" cellpadding="3" width="100%">
                <tr>
                    <td><textarea id="intro" name="intro" cols="60" rows="4"  ><?php echo $info['intro'];?></textarea></td>
                </tr>
            </table>
            <!-- 从业经历 -->
            <table id="table_pic_list" style="display:none;" class="tab_content" cellspacing="1" cellpadding="3" width="100%">
                <tr>
                    <td><input id="btn_add_pic" type="button" value="添加职业经历" /></td>
                </tr>
            <?php foreach( explode('-----',$info['pass']) as $k => $v ):?>
                <tr>
                    <td><textarea style="width:300px;height:60px;" name="pass[]"><?php echo $v;?></textarea></td>
                </tr>
            <?php endforeach;?>
            </table>
            <!-- 提交按钮 -->
            <table cellspacing="1" cellpadding="3" width="100%">
                <tr>
                    <td colspan="2" align="center"><br />
                        <input type="submit" class="button" value=" 确定 " />
                        <input type="reset" class="button" value=" 重置 " />
                        <input type="hidden" name="hos_id" value="<?php echo $info['hos_id'];?>" />
                        <input type="hidden" name="id" value="<?php echo $info['id'];?>" />
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>

<script>
UM.getEditor('intro', {
    initialFrameWidth : "80%"
});
function addNewExtCat(btn)
{
    // 选择后面的下拉框并克隆一个
    var newSel = $(btn).next("select").clone();
    // 把新的下拉框添加到当前TD的最后
    $(btn).parent().append(newSel);
}
// 为类型绑定change事件
$("select[name=province]").change(function(){
    // 先取出选择的类型ID
    var province = $(this).val();
    province = encodeURI(encodeURI(province));
    var html = '';
    $.ajax({
        type : "GET",
        url : "<?php echo U('ajaxGetCitys', '', FALSE); ?>/province/"+province,
        dataType : "json",
        success : function(data)
        {
            //拼接代码
            $(data).each(function(k,v){
                html += "<option value='"+v+"'>"+v;
                html += "</option>";
            });
            //把代码追加到select[name='city']
            $("select[name=city]").html(html);
        }
    });
});
function onloadAjax()
{
    var province = $("select[name=province]").val();
    province = encodeURI(encodeURI(province));
    var html = '';
    if( province )
    {
        $.ajax({
            type : "GET",
            url : "<?php echo U('ajaxGetCitys', '', FALSE); ?>/province/"+province,
            dataType : "json",
            success : function(data)
            {
                //拼接代码
                $(data).each(function(k,v){
                    html += "<option value='"+v+"'>"+v;
                    html += "</option>";
                });
                //把代码追加到select[name='city']
                $("select[name=city]").html(html);
            }
        });     
    }
    else
    {
        html = "<option valuse=''>请选择城市</option>";
        //把代码追加到select[name='city']
        $("select[name=city]").html(html);
    }
}
//网页加载完成  调用
onloadAjax();



// +号的事件
function addRow(a)
{
    // 先选中所在的LI标签
    var li = $(a).parent();
    if(li.find('a').html() == '[+]')
    {
        // 克隆一个新的LI
        var newLi = li.clone();
        // 变成-号
        newLi.find('a').html('[-]');
        // 新LI放到LI后面
        li.after(newLi);
    }
    else
        li.remove();
}
$("#tabbar-div p span").click(function(){
    // 获取点击的是第几个
    var i = $(this).index();
    // 先隐藏所有的table
    $(".tab_content").hide();
    // 显示第i个
    $(".tab_content").eq(i).show();
    $(".tab-front").removeClass("tab-front").addClass('tab-back');
    $(this).removeClass("tab-back").addClass('tab-front');
});

$("#btn_add_pic").click(function(){
    $("#table_pic_list").append('<tr><td><textarea style="width:300px;height:60px;" name="pass[]"></textarea></td></tr>');
});
</script>















